<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>로컬 스케줄 입력기</title>
  <style>
    :root{
      --bg:#f7fafc;
      --card:#ffffff;
      --accent:#2563eb;
      --muted:#6b7280;
      --success:#16a34a;
      --danger:#ef4444;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:linear-gradient(180deg,var(--bg), #eef2ff);
      padding:24px;
      color:#111827;
      -webkit-font-smoothing:antialiased;
    }
    .wrap{
      max-width:900px;
      margin:16px auto;
      display:grid;
      grid-template-columns:1fr 380px;
      gap:20px;
    }
    header{grid-column:1/-1; text-align:center}
    h1{margin:0 0 6px; font-size:20px}
    p.lead{margin:0;color:var(--muted);font-size:14px}

    /* Form card */
    .card{
      background:var(--card);
      border-radius:12px;
      padding:18px;
      box-shadow:0 6px 18px rgba(2,6,23,0.06);
    }
    label{display:block;font-weight:600;margin-bottom:6px;font-size:13px}
    .field{margin-bottom:12px}
    input[type=text], input[type=date], textarea{
      width:100%;
      padding:10px 12px;
      border:1px solid #e6edf8;
      border-radius:8px;
      font-size:14px;
      outline:none;
    }
    textarea{min-height:92px;resize:vertical}
    .actions{display:flex;gap:8px;align-items:center}
    button.btn{
      padding:10px 12px;border-radius:9px;border:0;font-weight:600;cursor:pointer;
    }
    .btn-primary{background:var(--accent);color:white}
    .btn-ghost{background:transparent;border:1px solid #e6edf8;color:var(--accent)}

    /* Schedule list */
    .list-col{
      display:flex;
      flex-direction:column;
      gap:12px;
      max-height:420px; /* 약 6개 항목 이후 스크롤 */
      overflow-y:auto;
      padding-right:4px;
    }
    .list-col::-webkit-scrollbar{width:6px;}
    .list-col::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:4px;}
    .list-col::-webkit-scrollbar-thumb:hover{background:#94a3b8;}

    .empty{color:var(--muted);padding:20px;border-radius:8px;text-align:center}
    .item{
      display:flex;gap:12px;align-items:flex-start;padding:12px;border-radius:10px;border:1px solid #f1f5f9;background:linear-gradient(180deg,#fff,#fbfdff);
    }
    .item .left{width:36px;display:flex;align-items:center}
    .meta{flex:1}
    .title{font-weight:700}
    .date{font-size:13px;color:var(--muted);margin-top:4px}
    .desc{margin-top:8px;color:#374151;font-size:14px}
    .controls{display:flex;flex-direction:column;gap:8px;align-items:flex-end}
    .small{font-size:12px;padding:6px 8px;border-radius:8px}
    .delete{background:var(--danger);color:white;border:0}
    .done{background:var(--success);color:white;border:0}
    .completed .title, .completed .desc{text-decoration:line-through;color:#9ca3af}

    /* responsive */
    @media (max-width:880px){
      .wrap{grid-template-columns:1fr;}
    }
    footer{grid-column:1/-1;margin-top:8px;text-align:center;color:var(--muted);font-size:13px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>로컬 스케줄 입력기</h1>
      <p class="lead">스케줄 이름, 날짜, 설명을 입력하고 체크로 완료 표시를 할 수 있습니다. 데이터는 브라우저에 저장됩니다.</p>
    </header>

    <!-- Form column -->
    <section class="card">
      <form id="scheduleForm" autocomplete="off">
        <div class="field">
          <label for="name">스케줄 이름</label>
          <input id="name" type="text" placeholder="예: 회의, 운동, 숙제" required />
        </div>
        <div class="field">
          <label for="date">날짜</label>
          <input id="date" type="date" />
        </div>
        <div class="field">
          <label for="desc">설명</label>
          <textarea id="desc" placeholder="간단한 메모를 적어보세요 (선택)"></textarea>
        </div>
        <div class="field actions">
          <button class="btn btn-primary" type="submit">추가하기</button>
          <button class="btn btn-ghost" type="button" id="clearAll">모두삭제</button>
          <div style="margin-left:auto;color:var(--muted);font-size:13px">저장: localStorage</div>
        </div>
      </form>
    </section>

    <!-- List column -->
    <aside class="card">
      <h3 style="margin-top:0;margin-bottom:10px">내 스케줄</h3>
      <div id="list" class="list-col">
        <div class="empty">스케줄이 없습니다. 왼쪽에서 추가하세요.</div>
      </div>
    </aside>

    <footer>간단한 로컬 스케줄 관리기 — 저장된 데이터는 이 브라우저에만 남습니다.</footer>
  </div>

  <script>
    const FORM = document.getElementById('scheduleForm');
    const LIST = document.getElementById('list');
    const KEY = 'local_schedules_v1';

    function loadSchedules(){
      try{
        const raw = localStorage.getItem(KEY);
        return raw ? JSON.parse(raw) : [];
      }catch(e){
        console.error('파싱에러', e);
        return [];
      }
    }

    function saveSchedules(arr){
      localStorage.setItem(KEY, JSON.stringify(arr));
    }

    function render(){
      const data = loadSchedules();
      LIST.innerHTML = '';
      if(!data.length){
        LIST.innerHTML = '<div class="empty">스케줄이 없습니다. 왼쪽에서 추가하세요.</div>';
        return;
      }
      // 날짜가 빠른 순으로 정렬 (가장 급한 일 위로)
      data.sort((a,b)=>{
        if(!a.date && !b.date) return 0;
        if(!a.date) return 1;
        if(!b.date) return -1;
        return new Date(a.date) - new Date(b.date);
      });

      data.forEach(item=>{
        const wrap = document.createElement('div');
        wrap.className = 'item' + (item.done? ' completed':'');
        const left = document.createElement('div');
        left.className = 'left';
        const cb = document.createElement('input');
        cb.type = 'checkbox';
        cb.checked = !!item.done;
        cb.addEventListener('change', ()=>{
          toggleDone(item.id);
        });
        left.appendChild(cb);

        const meta = document.createElement('div');
        meta.className = 'meta';
        const title = document.createElement('div');
        title.className = 'title';
        title.textContent = item.name || '(이름없음)';
        const date = document.createElement('div');
        date.className = 'date';
        date.textContent = item.date ? new Date(item.date).toLocaleDateString() : '날짜 없음';
        const desc = document.createElement('div');
        desc.className = 'desc';
        desc.textContent = item.desc || '';
        meta.appendChild(title);
        meta.appendChild(date);
        if(item.desc) meta.appendChild(desc);

        const controls = document.createElement('div');
        controls.className = 'controls';
        const del = document.createElement('button');
        del.className = 'small delete';
        del.textContent = '삭제';
        del.addEventListener('click', ()=>{ if(confirm('정말 삭제할까요?')) deleteItem(item.id); });
        const edit = document.createElement('button');
        edit.className = 'small';
        edit.textContent = '편집';
        edit.addEventListener('click', ()=>{ openEdit(item.id); });
        controls.appendChild(edit);
        controls.appendChild(del);

        wrap.appendChild(left);
        wrap.appendChild(meta);
        wrap.appendChild(controls);
        LIST.appendChild(wrap);
      });
    }

    function addSchedule(obj){
      const arr = loadSchedules();
      arr.push(obj);
      saveSchedules(arr);
      render();
    }

    function toggleDone(id){
      const arr = loadSchedules();
      const idx = arr.findIndex(x=>x.id===id);
      if(idx>-1){ arr[idx].done = !arr[idx].done; saveSchedules(arr); render(); }
    }

    function deleteItem(id){
      let arr = loadSchedules();
      arr = arr.filter(x=>x.id!==id);
      saveSchedules(arr);
      render();
    }

    function openEdit(id){
      const arr = loadSchedules();
      const item = arr.find(x=>x.id===id);
      if(!item) return alert('항목을 찾을 수 없습니다.');
      document.getElementById('name').value = item.name;
      document.getElementById('date').value = item.date || '';
      document.getElementById('desc').value = item.desc || '';
      FORM.dataset.editing = id;
      document.querySelector('.btn-primary').textContent = '수정저장';
    }

    FORM.addEventListener('submit', e=>{
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      const date = document.getElementById('date').value;
      const desc = document.getElementById('desc').value.trim();
      if(!name){ alert('스케줄 이름을 입력해 주세요.'); return; }
      if(FORM.dataset.editing){
        const id = Number(FORM.dataset.editing);
        const arr = loadSchedules();
        const idx = arr.findIndex(x=>x.id===id);
        if(idx>-1){
          arr[idx].name = name;
          arr[idx].date = date || null;
          arr[idx].desc = desc;
          saveSchedules(arr);
          delete FORM.dataset.editing;
          document.querySelector('.btn-primary').textContent = '추가하기';
          FORM.reset();
          render();
        }
        return;
      }
      const item = {id: Date.now(), name, date: date || null, desc, done:false};
      addSchedule(item);
      FORM.reset();
    });

    document.getElementById('clearAll').addEventListener('click', ()=>{
      if(confirm('저장된 모든 스케줄을 삭제합니다. 계속할까요?')){
        localStorage.removeItem(KEY);
        render();
      }
    });

    render();
  </script>
</body>
</html>
